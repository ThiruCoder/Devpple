(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2678],{5647:function(t,e,o){"use strict";o.d(e,{N:function(){return r}});var s=o(57437),n=o(2265),a=o(64798),i=o.n(a);let r=t=>{let e=(0,n.forwardRef)((e,o)=>{let{children:n}=e,a=t=>{let{resetFocusDelay:o=500}=e;t&&setTimeout(()=>{t.removeAttribute("tabindex")},o)},r=t=>{let{resetFocusDelay:o=500}=e;t&&setTimeout(()=>{t.tabIndex=0},o)},l=i()(()=>{let{resetAccessibilityFocusTargetId:t,resetFocusTabIndexToZero:o,removeTabIndexAttribute:s,resetFocusDelay:n=500}=e,i=document.querySelector(t)||document.body;i&&(i.tabIndex=-1),setTimeout(()=>{null==i||i.focus(),o&&r(i),s&&a(i)},n)},500);return(0,s.jsx)(t,{...e,ref:o,resetAccessibilityFocus:l,children:n})});return e.displayName="AccessibilityResetFocusComponent",e}},57472:function(t,e,o){"use strict";o.d(e,{He:function(){return a},Jz:function(){return T},u_:function(){return A},tC:function(){return R},w8:function(){return i},pU:function(){return P},f7:function(){return v},lp:function(){return O}});var s,n,a,i,r=o(50403),l=o(88632),c=o(93213);let d=(t,e)=>{Object.keys(t).forEach(o=>{e.setAttribute(o,t[o])})},u=(t,e)=>{if(e){let o=e.closeButtonAttr,s=e.modalAttr;o&&d(o,t.elements.closeButton),s&&d(s,t.elements.container)}},h=(t,e)=>{let o=e&&e.overlayClickHandler;if(o){let e=t=>{t.target.hasAttribute("data-modal-close")&&(t.stopPropagation(),o(t))};t.on(r.He.OPEN,()=>{t.elements.overlayContainer.addEventListener("click",e)}),t.on(r.He.CLOSE,()=>{t.elements.overlayContainer.removeEventListener("click",e)})}},g=(t,e)=>{let o=e&&e.escapeHandler;if(o){let e=t=>{t.keyCode===c.aT.ESCAPE&&(t.stopPropagation(),o(t))};t.on(r.He.OPEN,()=>{document.addEventListener("keydown",e)}),t.on(r.He.CLOSE,()=>{document.removeEventListener("keydown",e)})}},m=(t,e,o,s)=>{switch(s.type){case r.w8.STANDARD:return t;case r.w8.FULL_VIEWPORT:return e;case r.w8.MIXED:return o;default:return t}},p=(t,e,o)=>t.combine([{mixin:e,breakpointMask:"S"},{mixin:o,breakpointMask:"ML"}]),S=t=>{let e=l.G.getModalModule(),o=l.G.getModalMixinMask(),{FullBleed:s,PageOverlay:n,ScrollPosition:a,Open:i,Close:r,CloseButton:c,Focus:d,Keyboard:u}=l.G.getModalModuleMixins(),h=p(o,s,n),g=m(n,s,h,t);return e.withMixins(g,a,i,r,c,d,u)};function v(t,e){let o=new(S(e))(t);return h(o,e),g(o,e),u(o,e),o}var y=o(33509),f=o(57437),E=o(2265);(s=a||(a={})).WILL_OPEN="willopen",s.OPEN="open",s.WILL_CLOSE="willclose",s.CLOSE="close",(n=i||(i={}))[n.STANDARD=0]="STANDARD",n[n.FULL_VIEWPORT=1]="FULL_VIEWPORT",n[n.MIXED=2]="MIXED";var L=o(44521),b=o(35088),C=o(70174),N=o(84772),I=o.n(N);o(86813);let T=300,R=E.createContext({});class A extends E.Component{render(){let t=I()([this.state.isInitialized?"":"visuallyhidden","fill-parent"]);return(0,f.jsx)("div",{children:(0,f.jsx)("div",{className:t,ref:this.modalContent,children:this.props.children})})}componentDidMount(){(0,L.j)()&&(this.acModalLibrary||(this.acModalLibrary=l.G.getModalModule()),this.createModal())}componentWillUnmount(){this.modalInstance&&(this.resetPreventScrolling(),this.removeListeners(),this.modalInstance.destroy())}UNSAFE_componentWillReceiveProps(t){if(!this.modalInstance)return;let{isOpened:e,type:o,hideCloseButton:s,ariaLabel:n,ariaLabelledBy:a,standBy:i,reverseAriaLabelElements:r}=t,{isOpened:l,standBy:c,type:d,hideCloseButton:u,ariaLabel:h,ariaLabelledBy:g}=this.props;if(s!==u&&(s?document.documentElement.classList.add("modal-close-hidden"):document.documentElement.classList.remove("modal-close-hidden")),i&&c&&i.enable!==c.enable&&!i.enable){let t=document.documentElement.querySelectorAll(".modal"),e=t.length;for(let o=0;o<e;o++){let e=t[o];e.classList.remove("modal-stand-by"),e.classList.remove("modal-stand-in")}this.modalContentPadding.setAttribute("style",this.modalStyles),this.modalContentPadding.addEventListener("transitionend",this.onTransitionEndBound)}let m=n!==h||a!==g,p=i&&(i.enable||i.shouldEnable);(e!==l||o!==d||m)&&e&&this.setAriaAttributes(n,a,r),e&&(p||i&&i.enable)&&document.documentElement.classList.add("is-stand-by-modal"),this.standBy=i;let S=Object.values(this.modalElement.classList).includes("modal-open");t.isOpened&&!S?this.modalInstance.open():!t.isOpened&&S&&this.modalInstance.close()}close(){this.modalInstance.close()}setFocus(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;setTimeout(()=>{this.state.readyToClose?this.modalElement.focus():this.state.activeSelect&&this.state.activeSelect.focus()},t)}createModal(){let{type:t,isOpened:e=!1,classList:o,overlayClickHandler:s,closeButtonOverrideHandler:n,escapeHandler:i,closeButtonAttr:l,modalAttr:c}=this.props;this.modalInstance=(0,r.f7)(this.modalContent.current,{overlayClickHandler:s,escapeHandler:i,closeButtonAttr:l,modalAttr:c,type:t}),this.modalElement=this.modalInstance.elements.container,this.modalOverlay=this.modalElement.querySelector(".modal-overlay");let d=this.modalElement.querySelectorAll("select").length>0;this.modalContentPadding=this.modalElement.querySelector(".modal-content-container"),o&&this.modalElement.classList.add(...o),this.modalInstance.on(a.OPEN,this.onModalOpen),this.modalInstance.on(a.WILL_OPEN,this.onModalWillOpen),this.modalInstance.on(a.CLOSE,this.onModalClose),this.modalInstance.on(a.WILL_CLOSE,this.onModalWillClose),this.setState({isInitialized:!0,readyToClose:!0}),e&&this.modalInstance.open(),n&&this.attachCloseButtonHandler(n),this.props.enableContentScrolling||this.preventScrolling(),d&&this.addListeners()}setAriaAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=o?this.modalElement:this.modalOverlay,n=o?this.modalOverlay:this.modalElement;""!==t&&(null==s||s.setAttribute("aria-label",t)),""!==e&&(null==n||n.setAttribute("aria-labelledby",e))}attachCloseButtonHandler(t){if(this.modalInstance){let e=this.modalInstance.elements.closeButton,o=this.modalInstance.elements.closeIcon;e.addEventListener("keydown",e=>{(e.keyCode===c.aT.ENTER||e.keyCode==c.aT.SPACE)&&(e.preventDefault(),t(e))}),o.addEventListener("click",e=>{e.stopPropagation(),t(e)})}}preventScrolling(){this.modalElement.addEventListener("touchstart",this.onTouchStart,{capture:!0,passive:!1}),this.modalElement.addEventListener("touchmove",this.onTouchMove,{capture:!0,passive:!1})}resetPreventScrolling(){this.modalElement.removeEventListener("touchstart",this.onTouchStart,{capture:!0}),this.modalElement.removeEventListener("touchmove",this.onTouchMove,{capture:!0})}addListeners(){this.modalElement.addEventListener("keydown",this.keyListener),this.modalElement.addEventListener("mousedown",this.clickListener)}removeListeners(){this.modalElement.removeEventListener("keydown",this.keyListener),this.modalElement.removeEventListener("mousedown",this.clickListener)}onModalWillOpen(){let{onWillOpen:t=()=>null,shouldStandBy:e}=this.props;if(this.modalElement.scrollTop=0,this.standBy&&this.standBy.enable&&!e){this.modalStyles=(0,r.lp)(window.getComputedStyle(this.modalContentPadding),this.cssStyleProps),this.modalElement.classList.add("modal-stand-in"),this.modalContentPadding.setAttribute("style",this.standBy.styles);let t=document.documentElement.querySelectorAll(".modal"),e=t.length;for(let o=0;o<e;o++)t[o].classList.remove("modal-stand-by")}t()}onModalOpen(){let{onOpen:t=()=>null,retainScrollPosition:e,setModalContext:o}=this.props;window&&(this.windowScrollY=window.scrollY,e&&window.navigator.userAgent.match(/iPhone/i)&&setTimeout(()=>{window.scroll(0,0)})),this.standBy&&this.standBy.enable&&(this.modalContentPadding.setAttribute("style",this.standBy.styles),o&&o({enable:!1})),this.setFocus(T),t()}onModalWillClose(){let{onWillClose:t=()=>null}=this.props;this.standBy&&this.standBy.shouldEnable&&this.modalElement.classList.add("modal-stand-by"),this.setFocus(),t()}onModalClose(){let{onClose:t=()=>null,retainScrollPosition:e,setModalContext:o}=this.props,s=new C.qD;if(window&&e&&s.windowScrollToY(this.windowScrollY),this.standBy&&this.standBy.shouldEnable){let t=this.modalContentPadding.getBoundingClientRect().top;document.documentElement.classList.add("has-modal"),o&&o({enable:!0,styles:"".concat((0,r.lp)(window.getComputedStyle(this.modalContentPadding),this.cssStyleProps)," ").concat(t<0?"top: ".concat(t-54,"px"):"")})}!this.props.standBy||this.props.standBy.enable||this.props.standBy.shouldEnable||document.documentElement.classList.remove("is-stand-by-modal"),this.state.readyToClose?t():this.modalInstance.open()}onTouchStart(t){this.touchStartY=t.touches[0].screenY}onTouchMove(t){if(this.props.enableContentScrolling)return;let e=t.currentTarget||this.modalElement,o=t.touches[0].screenY,s=this.touchStartY<=o&&0===e.scrollTop,n=this.touchStartY>=o&&e.scrollHeight-e.scrollTop===e.getBoundingClientRect().height;(s||n)&&t.preventDefault()}onTransitionEnd(t){("opacity"===t.propertyName||"visibility"===t.propertyName)&&(this.modalContentPadding.removeAttribute("style"),this.modalContentPadding.removeEventListener("transitionend",this.onTransitionEndBound))}keyListener(t){let e=this.modalElement.querySelectorAll("select"),o=document.activeElement,s=Array.from(e).includes(o);(t.keyCode===c.aT.DOWN||t.keyCode===c.aT.UP||t.keyCode===c.aT.SPACE)&&s?this.setState({readyToClose:!1,activeSelect:t.target}):this.setState({readyToClose:!0})}clickListener(t){let e=this.modalElement.querySelectorAll("select"),o=t.target;Array.from(e).includes(o)?this.setState({readyToClose:!1,activeSelect:t.target}):this.setState({readyToClose:!0})}constructor(t){super(t),this.touchStartY=0,this.windowScrollY=0,this.modalStyles="",this.cssStyleProps=["width","height","padding","top","right","bottom","left","flex"],this.modalContent=E.createRef(),this.onTransitionEndBound=this.onTransitionEnd.bind(this),this.state={isInitialized:!1,readyToClose:!1,activeSelect:null}}}A.defaultProps={hideCloseButton:!1,type:i.STANDARD},(0,y.__decorate)([b.m],A.prototype,"onModalWillOpen",null),(0,y.__decorate)([b.m],A.prototype,"onModalOpen",null),(0,y.__decorate)([b.m],A.prototype,"onModalWillClose",null),(0,y.__decorate)([b.m],A.prototype,"onModalClose",null),(0,y.__decorate)([b.m],A.prototype,"onTouchStart",null),(0,y.__decorate)([b.m],A.prototype,"onTouchMove",null),(0,y.__decorate)([b.m],A.prototype,"onTransitionEnd",null),(0,y.__decorate)([b.m],A.prototype,"keyListener",null),(0,y.__decorate)([b.m],A.prototype,"clickListener",null);let O=(t,e)=>Object.entries(t).reduce((t,o)=>{let[s,n]=o;if(e.includes(s)){let e=s.replace(/\B([A-Z])(?=[a-z])/g,"-$1").replace(/\B([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();return t+"".concat(e,": ").concat(n,";")}return t},"");class P{animate(t,e,o){let s=["width","height","padding","margin","top","right","bottom","left","flex"];this.callBack=o,this.fromContent=t,this.toContent=e,document.documentElement.classList.add(this.cNames.MODAL_IS_ANIMATING),this.toContent.classList.add(this.cNames.PRE_TRANS,this.cNames.BASE),this.toContent.classList.remove(this.cNames.HIDE),this.fromContentStyles=O(window.getComputedStyle(this.fromContent),s),this.toContentStyles=O(window.getComputedStyle(this.toContent),s),this.fromContent.addEventListener("transitionend",this.onAnimateOutEndBound),this.fromContent.classList.add(this.cNames.BASE),this.toContent.setAttribute("style",this.fromContentStyles)}reset(){var t,e,o,s,n,a;null===(t=this.fromContent)||void 0===t||t.classList.remove(...Object.values(this.cNames)),null===(e=this.toContent)||void 0===e||e.classList.remove(...Object.values(this.cNames)),document.documentElement.classList.remove(this.cNames.MODAL_IS_ANIMATING),null===(o=this.fromContent)||void 0===o||o.removeAttribute("style"),null===(s=this.toContent)||void 0===s||s.removeAttribute("style"),null===(n=this.toContent)||void 0===n||n.removeEventListener("transitionend",this.onAnimateInEndBound),null===(a=this.fromContent)||void 0===a||a.removeEventListener("transitionend",this.onAnimateOutEndBound)}onAnimateInEnd(t){if("opacity"===t.propertyName){var e,o,s,n;document.documentElement.classList.remove(this.cNames.MODAL_IS_ANIMATING),null===(e=this.toContent)||void 0===e||e.classList.remove(this.cNames.BASE,this.cNames.TRANS),null===(o=this.toContent)||void 0===o||o.removeEventListener("transitionend",this.onAnimateInEndBound),null===(s=this.toContent)||void 0===s||s.classList.add(this.cNames.SHOW),null===(n=this.toContent)||void 0===n||n.removeAttribute("style"),this.callBack&&this.callBack()}}onAnimateOutEnd(t){if("opacity"===t.propertyName){var e,o,s,n,a,i,r;null===(e=this.fromContent)||void 0===e||e.removeEventListener("transitionend",this.onAnimateOutEndBound),null===(o=this.fromContent)||void 0===o||o.classList.remove(this.cNames.SHOW),null===(s=this.fromContent)||void 0===s||s.classList.add(this.cNames.HIDE),null===(n=this.toContent)||void 0===n||n.classList.remove(this.cNames.PRE_TRANS),null===(a=this.toContent)||void 0===a||a.classList.add(this.cNames.TRANS),null===(i=this.toContent)||void 0===i||i.addEventListener("transitionend",this.onAnimateInEndBound),null===(r=this.toContent)||void 0===r||r.setAttribute("style",this.toContentStyles)}}constructor(){this.cNames={BASE:"transition-in-modal-content",PRE_TRANS:"transition-in-modal-content__pre-transition",TRANS:"transition-in-modal-content__transition",HIDE:"transition-in-modal-content__content-hide",SHOW:"transition-in-modal-content__content-show",MODAL_IS_ANIMATING:"modal-is-animating"},this.onAnimateInEndBound=this.onAnimateInEnd.bind(this),this.onAnimateOutEndBound=this.onAnimateOutEnd.bind(this)}}},50403:function(t,e,o){"use strict";o.d(e,{He:function(){return s.He},Jz:function(){return s.Jz},f7:function(){return s.f7},lp:function(){return s.lp},pU:function(){return s.pU},tC:function(){return s.tC},u_:function(){return s.u_},w8:function(){return s.w8}});var s=o(57472)},16799:function(t,e,o){"use strict";o.d(e,{Si:function(){return a},lx:function(){return n},nN:function(){return r},IY:function(){return d}});var s=o(38452);class n{async onLocationChangedCallback(t){var e,o,n,a,i;let{selectedLocationInfo:r,refreshPage:l,closeCallback:c,errorCallback:d}=t,{i18n:u,sessionStorage:h,logger:g,allLocales:m,match:p}=this,{selectedLocation:S,coordinates:v}=r,y=S&&S.country,f=S&&S.store;if(v)h.updateLocationToSelectedByCoordinates(v,!0);else{let{includeNearbyStores:t}=S;if(!this.hasAvailableResults(r)&&d){d(u.value("error.no-results-for-location"));return}d||g.warn("".concat(u.value("error.no-results-for-location")," - No errorCallback provided to onLocationChangedCallback")),f&&y?h.updateLocationToSelectedByStore({locale:m.getLocaleByStageRootPath(y.stageRootPath).id,slug:f.slug,storeNum:f.storeNum},t):g.warn("No store and/or country data available - see DefaultLocationUpdateStrategy")}let E=this.getParamsWithUpdatedNearBy(S);if(null===(e=this.actions)||void 0===e?void 0:e.callbackBeforeModalCloses){if(v)await (null===(n=this.actions)||void 0===n?void 0:null===(o=n.callbackBeforeModalCloses)||void 0===o?void 0:o.call(n,{routeParams:{stageRootPath:(0,s.$r)(this.configManager,m.currentLocale.stageRootPath)},queryParams:{},location:v,refreshPage:l}));else{let{includeNearbyStores:t,store:e}=S,o=S&&S.country,s=o&&o.stageRootPath||null,n=e&&e.slug||null;await (null===(i=this.actions)||void 0===i?void 0:null===(a=i.callbackBeforeModalCloses)||void 0===a?void 0:a.call(i,{routeParams:{stageRootPath:null!=s?s:"",storeLocation:null!=n?n:""},queryParams:{nearby:t?t.toString():void 0},refreshPage:l}))}}await c();let L=null;if(y&&(L=m.getLocaleByStageRootPath(y.stageRootPath).urlStageRootPath),l){let t=(0,s.ai)(y.isoCountryCode,this.configManager,this.configManager.getMainSiteUrl(null==y?void 0:y.stageRootPath));v&&E.set(s.az.USE_MY_LOCATION,"true");let e=E.toString(),o="".concat(t).concat((0,s.Vf)(this.configManager.getPageRoute(this.pageName),{...p,stageRootPath:L||void 0,storeLocation:f&&f.slug||void 0,marketSlug:void 0})).concat(e?"?"+e:"");window.location.href=o}else{let t=E.toString(),e=v?{...p,stageRootPath:null!=L?L:(0,s.$r)(this.configManager,m.currentLocale.stageRootPath),storeLocation:void 0,marketSlug:void 0}:{...p,stageRootPath:null!=L?L:(0,s.$r)(this.configManager,m.currentLocale.stageRootPath),storeLocation:f&&f.slug||void 0,marketSlug:void 0},o={pathname:(0,s.Vf)(this.configManager.getPageRoute(this.pageName),e)};t&&(o.search="?".concat(t));let n=o.search?o.pathname+o.search:o.pathname;window.history.pushState({},"",n)}}hasAvailableResults(t){let{selectedLocation:e}=t,o=e&&e.country,s=e&&e.store;return this.ignoreStoreCountCheck||o&&0!==o.virtualScheduleCount||!(!s||(e.includeNearbyStores?s.nearbyScheduleCount:s.scheduleCount)===0)}getParamsWithUpdatedNearBy(t){let e=new URLSearchParams(document.location.search);return t&&t.includeNearbyStores?e.set(s.az.NEAR_BY,"true"):e.delete(s.az.NEAR_BY),e}constructor({i18n:t,sessionStorage:e,allLocales:o,pageName:s,logger:n,configManager:a,match:i,actions:r}){this.i18n=t,this.sessionStorage=e,this.allLocales=o,this.pageName=s,this.logger=n,this.ignoreStoreCountCheck=!1,this.configManager=a,this.match=i,this.actions=r}}class a extends n{async onLocationChangedCallback(t){let{selectedLocationInfo:e,refreshPage:o,closeCallback:s,errorCallback:n,router:a}=t;await super.onLocationChangedCallback({selectedLocationInfo:e,refreshPage:o,closeCallback:s,errorCallback:n,router:a}),this.sessionStorage.removeCalendarSelectedDate()}constructor(t){super(t)}}var i=o(58679);class r{async onLocationChangedCallback(t){let{selectedLocationInfo:e,refreshPage:o,closeCallback:s,errorCallback:n}=t,{eventPDS:a,match:i,i18n:r,sessionStorage:l,allLocales:c}=this,{selectedLocation:d,coordinates:u}=e,h=d&&d.country,g=d&&d.store;if(u){if(o)alert(r.value("error.unable-change-country"));else{let{lat:t,long:e}=u,o=await a.getPageData({...i,scheduleId:void 0},{},{lat:t,long:e});o&&o.schedule?(l.updateLocationToSelectedByCoordinates(u,!0),o.userLocation&&l.setLocationLabelInfo(o.userLocation),this.updatePageState(o,s)):alert(r.value("error.no-results-for-location"))}}else{if(!d||!h||!g)return;let{includeNearbyStores:t}=d,e=await a.getPageData({...i,stageRootPath:h.stageRootPath},{nearby:t?t.toString():void 0,selectedStore:{storeNum:g.storeNum,slug:g.slug,locale:c.currentLocale.id}},null);if(e&&e.schedule){if(!g||!h)return;l.updateLocationToSelectedByStore({storeNum:g.storeNum,slug:g.slug,locale:c.currentLocale.id},t),this.updatePageState(e,s)}else n&&n(r.value("error.no-results-for-location"))}}updatePageState(t,e){let{actions:o}=this;this.actions.updatePageData(t),e()}constructor({actions:t,allLocales:e,configManager:o,i18n:s,logger:n,match:a,pageName:r,sessionStorage:l}){this.actions=t,this.allLocales=e,this.configManager=o,this.i18n=s,this.logger=n,this.match=a,this.pageName=r,this.sessionStorage=l,this.eventPDS=new i.b(this.configManager,this.configManager.getApiBase(),this.logger)}}var l=o(98689),c=o(9200);class d extends n{async onLocationChangedCallback(t){let{selectedLocationInfo:e,refreshPage:o,closeCallback:s,errorCallback:n,router:a}=t,{i18n:i}=this,{selectedLocation:r,coordinates:l}=e;if(this.ignoreStoreCountCheck=!0,!l){let{includeNearbyStores:t,store:e}=r,o=r&&r.country,s=o&&o.stageRootPath||null,a=e&&e.slug||null;if(!await this.groupBookingPDS.getGroupBookingHasSessions({stageRootPath:null!=s?s:"",storeLocation:null!=a?a:""},{nearby:t?t.toString():void 0})){n&&n(i.value("error.no-results-for-location"));return}}o&&(this.clearAppliedFilters(),this.sessionStorage.removeGroupBookingForm()),await super.onLocationChangedCallback({selectedLocationInfo:e,refreshPage:o,closeCallback:s,errorCallback:n,router:a})}clearAppliedFilters(){let t=new URLSearchParams(document.location.search);t.delete(l.b.TOPICS),t.delete(l.b.DURATIONS),t.delete(l.b.SESSION),window.history.replaceState(null,"","?".concat(t))}constructor(t){super(t),this.groupBookingPDS=new c.U(this.configManager,this.configManager.getApiBase(),this.logger)}}},75572:function(t,e,o){"use strict";o.d(e,{i:function(){return P}});var s,n,a=o(57437),i=o(2265),r=o(99376),l=o(84772),c=o.n(l),d=o(11716);o(95650);class u extends i.Component{componentDidMount(){this.updateStoreTitle()}componentDidUpdate(){this.updateStoreTitle()}updateStoreTitle(){let t;let{isStoreSpecific:e,locationSelectorData:{i18n:o,locationData:s,sessionStorage:n},shouldConcreteStoreBeSelected:a}=this.props,{store:i}=s||{store:null},r=n.getNearbyFlag(),l=o.value("global.cta-change-location");i?(t=n.getUseMyLocationFlag()?o.value("global.change-location-near"):a&&!r||e?i.address.title:o.compileValue("global.change-location-area",i.address),l="".concat(t," - ").concat(l)):t=o.value("global.cta-change-location"),t!==this.state.buttonTitle&&this.setState({buttonTitle:t,ariaLabel:l})}render(){let{disabled:t,isLoading:e=!1,showButton:o}=this.props,s=c()("discover-location-button",{disabled:t});return this.state.buttonTitle&&(0,a.jsx)("button",{"aria-label":this.state.ariaLabel,"aria-disabled":t,id:"current-location-button",className:s,onClick:this.props.onClick,disabled:t,children:(0,a.jsx)("div",{className:"location-select-text-wrapper",children:o&&(0,a.jsxs)(a.Fragment,{children:[!e&&(0,a.jsx)(d.R.GEOLOCATION,{className:"current-location-icon"}),e&&(0,a.jsx)(d.R.LOADING,{className:"current-location-icon wait-indicator"}),this.state.buttonTitle]})})})}constructor(t){super(t),this.updateStoreTitle=this.updateStoreTitle.bind(this),this.state={buttonTitle:void 0,ariaLabel:void 0}}}var h=o(50403),g=o(38452),m=o(44521),p=o(18285);o(2652),(s=n||(n={}))[s.PERMISSION_DENIED=1]="PERMISSION_DENIED",s[s.POSITION_UNAVAILABLE=2]="POSITION_UNAVAILABLE",s[s.TIMEOUT=3]="TIMEOUT";class S extends i.Component{render(){let{i18n:t}=this.props.data,{isLoading:e}=this.state,o={name:"geolocate-button",className:"current-location-button typography-body-reduced",onClick:()=>this.geoButtonClick(),"data-analytics-click":new p.bK().withProp3("t@a - use my current location").withEvent("event345").build()};return(0,m.j)()&&(o.disabled=e||!this.canGetGeoLocation()),(0,a.jsx)("div",{className:"my-location-button-wrapper",children:(0,a.jsxs)("button",{...o,children:[(0,a.jsxs)("div",{className:"my-location-icon-wrapper",children:[!e&&(0,a.jsx)(d.R.GEOLOCATION,{className:"current-location-icon"}),e&&(0,a.jsx)(d.R.LOADING,{className:"geo-locate-load-status wait-indicator"})]}),(0,a.jsx)("div",{className:"my-location-text-wrapper",children:t.value("global.activate-geolocation-copy")})]})})}async geoButtonClick(){let{onResultCallback:t,data:{sessionStorage:e,config:o}}=this.props;this.startLoadingIndication(),e.setGeoButtonClicked();try{let{coords:{latitude:e,longitude:s}}=await this.getLocation();if(o.getProperty("geo").overrideGeo){let t=+(0,g.ce)("lat"),o=+(0,g.ce)("long");t&&o&&(e=t,s=o)}t({latitude:e,longitude:s})}catch(t){this.handleGeolocationError(t)}finally{this.stopLoadingIndication()}}getLocation(){return new Promise((t,e)=>{navigator.geolocation.getCurrentPosition(e=>t(e),t=>e(t),{enableHighAccuracy:!0,maximumAge:this.MAXIMUM_AGE,timeout:this.GEOLOCATION_TIMEOUT})})}canGetGeoLocation(){return(0,m.j)()&&"geolocation"in navigator}handleGeolocationError(t){let{onResultCallback:e}=this.props;e(1===t.code?{error:"error.geolocation-user-permission-denied"}:{error:"error.unable-to-get-geolocation"})}startLoadingIndication(){this.props.onStartLoading&&(this.setState({isLoading:!0}),this.props.onStartLoading())}stopLoadingIndication(){this.props.onEndLoading&&(this.setState({isLoading:!1}),this.props.onEndLoading())}constructor(t){super(t),this.GEOLOCATION_TIMEOUT=7e3,this.MAXIMUM_AGE=0,this.state={isLoading:!1}}}S.defaultProps={onStartLoading:()=>{},onEndLoading:()=>{}};var v=o(23006),y=o.n(v),f=o(21652),E=o.n(f);let L={COUNTRY:"ChooseCountry",STATE:"ChooseState",STORE:"ChooseStore"};class b extends i.PureComponent{componentDidMount(){let{currentGeoInfo:t}=this.props;t&&this.restoreSelectedValues(t)}componentDidUpdate(t){let{currentGeoInfo:e}=this.props;!E()(this.props.currentGeoInfo,t.currentGeoInfo)&&e&&this.restoreSelectedValues(e)}render(){var t=this;let{locationSelectorData:{i18n:e,allStores:o},setShowButton:s}=this.props,n=y()(this.DEFAULT_CONTROL_VISIBILITY,this.props.controlsVisibility),{selectedCountryIndex:i,selectedStateIndex:r,selectedStoreIndex:l,includeNearbyStores:d,errorMessage:u}=this.state,h=i!==L.COUNTRY;this.country=h&&o.countries[i];let g=this.country&&this.country.states,m=g&&r!==L.STATE;g?(this.states=this.country&&Object.values(this.country.states),this.stores=this.states&&this.states[r]?this.states[r].stores:null):(this.states=null,this.stores=this.country&&this.country.stores);let p=l!==L.STORE,S=!h||!m&&g,v=this.getSelectedStore(),f=v?v.storeNum:"",E=c()("form-row",(!h||!g)&&"form-no-display"),b=!!(this.stores&&this.stores[l]&&u);return(0,a.jsxs)("div",{id:"dropdown-selections",children:[n.country&&(0,a.jsx)("div",{className:"form-row",children:(0,a.jsx)("div",{className:"form-cell",children:(0,a.jsxs)("div",{className:"form-element",children:[(0,a.jsx)("label",{id:"select-country-label",className:"a11y",htmlFor:"select-country",children:e.value("global.change-location-country")}),(0,a.jsxs)("select",{className:"form-dropdown",id:"select-country","aria-invalid":"false","aria-required":"true",onChange:t=>this.countrySelected(t),value:i,children:[(0,a.jsx)("option",{className:"quote-subcredit",value:L.COUNTRY,disabled:h,children:e.value("global.change-location-country")}),o.countries.map((t,o)=>{let s=t.isoCountryCode.toLowerCase(),n=e.value("country.".concat(s));return t.isMultiLanguage&&(n=e.value("country.".concat(s))+" - "+e.value("language.".concat(t.isoLanguageCode))),(0,a.jsx)("option",{value:o,children:n},o)})]}),(0,a.jsx)("span",{className:"form-icon icon icon-chevrondown","aria-hidden":"true"})]})})}),n.state&&(0,a.jsx)("div",{className:E,children:(0,a.jsx)("div",{className:"form-cell",children:(0,a.jsxs)("div",{className:"form-element",children:[(0,a.jsx)("label",{id:"select-state-label",className:"a11y",htmlFor:"select-state",children:e.value("global.change-location-state")}),(0,a.jsxs)("select",{className:"form-dropdown",id:"select-state","aria-invalid":"false","aria-required":"true",onChange:t=>this.stateSelected(t),value:r,children:[(0,a.jsx)("option",{className:"quote-subcredit",value:L.STATE,disabled:m,children:e.value("global.change-location-state")}),this.states&&this.states.map((t,e)=>(0,a.jsx)("option",{value:e,children:t.name},e))]}),(0,a.jsx)("span",{className:"form-icon icon icon-chevrondown","aria-hidden":"true"})]})})}),n.store&&(0,a.jsx)("div",{className:"form-row",children:(0,a.jsx)("div",{className:"form-cell",children:(0,a.jsxs)("div",{className:"form-element",children:[(0,a.jsx)("label",{id:"select-store-label",className:"a11y",htmlFor:"select-store",children:e.value("global.change-location-store")}),(0,a.jsxs)("select",{className:"form-dropdown",id:"select-store","aria-invalid":"false","aria-required":"true",onChange:t=>this.storeSelected(t),value:l,disabled:S,children:[(0,a.jsx)("option",{className:"quote-subcredit",value:L.STORE,disabled:p,children:e.value("global.change-location-store")}),this.stores&&this.stores.map((t,e)=>(0,a.jsx)("option",{value:e,children:"".concat(t.address.city,", ").concat(t.address.name)},e))]}),(0,a.jsx)("span",{className:"form-icon icon icon-chevrondown","aria-hidden":"true"})]})})}),b&&(0,a.jsx)("div",{className:"form-row location-message empty-message","aria-hidden":"false",children:(0,a.jsx)("div",{className:"no-event-error",children:(0,a.jsx)("div",{"aria-live":"polite",className:"form-element form-message",children:u})})}),n.includeNearbyStores&&(0,a.jsx)("div",{className:"form-row",children:(0,a.jsx)("div",{className:"form-cell pattern-checkbox",children:(0,a.jsxs)("div",{className:"form-element form-element--nearby-stores form-checkbox",children:[(0,a.jsx)("input",{disabled:!p,id:"nearbyStores",name:"nearby",type:"checkbox",className:"form-checkbox-input",checked:d||!1,onChange:function(){for(var e=arguments.length,o=Array(e),s=0;s<e;s++)o[s]=arguments[s];return t.nearbyCheckboxSelected(...o)}}),(0,a.jsxs)("label",{htmlFor:"nearbyStores",className:"form-label form-checkbox-label",children:[(0,a.jsx)("span",{className:"form-checkbox-indicator"}),e.value("global.nearby-stores")]})]})})}),(0,a.jsx)("div",{className:"submit-row",children:(0,a.jsx)("button",{onClick:()=>this.onClick(),disabled:!p||!!u,name:"location-confirm",className:"pill-large button-confirm","data-analytics-click":'{"prop3": "t@a - select locale", "eVar74": "'+f+'"}',children:e.value("global.cta-apply")})})]})}nearbyCheckboxSelected(t){let{target:e}=t;this.setState({errorMessage:null,includeNearbyStores:e.checked})}countrySelected(t){let{target:e}=t;this.setState({errorMessage:null,selectedCountryIndex:e.value,selectedStateIndex:L.STATE,selectedStoreIndex:L.STORE})}stateSelected(t){let{target:e}=t;this.setState({errorMessage:null,selectedStateIndex:e.value,selectedStoreIndex:L.STORE})}storeSelected(t){let{target:e}=t;this.setState({errorMessage:null,selectedStoreIndex:e.value})}getSelectedStore(){let{selectedStoreIndex:t}=this.state;return this.stores&&"object"==typeof this.stores&&t?this.stores[t]:void 0}onClick(){let{selectedStateIndex:t,selectedStoreIndex:e,includeNearbyStores:o}=this.state;this.props.onApplyButtonClick({country:this.country,state:this.states&&"boolean"!=typeof this.states?this.states[t]:void 0,store:this.stores&&"boolean"!=typeof this.stores?this.stores[e]:void 0,includeNearbyStores:o},t=>this.setErrorMessage(t))}restoreSelectedValues(t){let{shouldConcreteStoreBeSelected:e,locationSelectorData:{allStores:o}}=this.props,s=o.countries.findIndex(e=>{var o;return e.stageRootPath===(null===(o=t.country)||void 0===o?void 0:o.stageRootPath)}),n=L.STATE,a=L.STORE;-1!==s&&t.country&&(t.country.states?(n=this.getStateIndex(t),a=this.getStoreIndexByState(t)):a=this.getStoreIndexByCountry(t)),this.setState({selectedCountryIndex:s,selectedStateIndex:n,selectedStoreIndex:e?a:L.STORE,includeNearbyStores:t.includeNearbyStores||!1})}getStoreIndexByCountry(t){let e=t.country&&t.country.stores?t.country.stores.findIndex(e=>{var o;return e.storeNum===(null===(o=t.store)||void 0===o?void 0:o.storeNum)}):-1;return -1!==e?e:L.STORE}getStoreIndexByState(t){let e;return t.state&&t.state.stores&&-1!==(e=t.state.stores.findIndex(e=>{var o;return e.storeNum===(null===(o=t.store)||void 0===o?void 0:o.storeNum)}))?e:L.STORE}getStateIndex(t){let e=t.country&&t.country.states?t.country.states.findIndex(e=>{var o;return e.name===(null===(o=t.state)||void 0===o?void 0:o.name)}):-1;return -1!==e?e:L.STATE}setErrorMessage(t){this.setState({errorMessage:t})}constructor(t){super(t),this.DEFAULT_CONTROL_VISIBILITY={country:!0,state:!0,store:!0,includeNearbyStores:!0},this.state={selectedCountryIndex:L.COUNTRY,selectedStateIndex:L.STATE,selectedStoreIndex:L.STORE,includeNearbyStores:!1,errorMessage:null}}}o(64400);class C extends i.Component{render(){var t=this;let{locationSelectorData:{i18n:e,sessionStorage:o,config:s},controlsVisibility:n,shouldConcreteStoreBeSelected:i,onStartLoading:r,onEndLoading:l,isOpened:c,onClose:d,ariaLabel:u,setShowButton:g}=this.props;return(0,a.jsx)(h.u_,{type:h.w8.MIXED,classList:["location-modal"],isOpened:c,onClose:d,ariaLabel:u||e.value("global.cta-change-location"),retainScrollPosition:!0,children:(0,a.jsxs)("div",{id:"location-modal-content",children:[(0,a.jsxs)("div",{className:"geolocation-options can-use-geolocation",children:[(0,a.jsxs)("fieldset",{className:"location-find-by-geolocation",children:[(0,a.jsx)("legend",{className:"location-modal-legend",children:(0,a.jsx)("h2",{className:"location-modal-title typography-eyebrow",children:e.value("global.change-geolocation-title")})}),(0,a.jsx)(S,{onStartLoading:r,onEndLoading:l,onResultCallback:function(){for(var e=arguments.length,o=Array(e),s=0;s<e;s++)o[s]=arguments[s];return t.myLocationSelected(...o)},data:{i18n:e,sessionStorage:o,config:s}})]}),(0,a.jsx)("hr",{className:"modal-separator","aria-hidden":"true"})]}),(0,a.jsxs)("fieldset",{className:"location-find-by-apple-store",children:[(0,a.jsx)("legend",{className:"location-modal-legend",children:(0,a.jsx)("h2",{className:"location-modal-title typography-eyebrow",children:e.value("global.select-apple-store-title")})}),(0,a.jsx)(b,{controlsVisibility:n,shouldConcreteStoreBeSelected:i,currentGeoInfo:this.getCurrentStoreGeoInfo(),onApplyButtonClick:function(){for(var e=arguments.length,o=Array(e),s=0;s<e;s++)o[s]=arguments[s];return t.applyButtonClick(...o)},locationSelectorData:this.props.locationSelectorData,setShowButton:t=>g(t)})]})]})})}getCurrentStoreGeoInfo(){let{locationSelectorData:{locationData:t,sessionStorage:e}}=this.props;return{...t,includeNearbyStores:e.getNearbyFlag()}}async myLocationSelected(t){let{onLocationChangedCallback:e,locationSelectorData:{locationData:o,allStores:s,sessionStorage:n,mapkitDataService:a}}=this.props;if(t.error)this.showErrorMessage(t.error);else try{var i,r;let l=t.latitude&&t.longitude?{lat:t.latitude,long:t.longitude}:n.getUserLocation(),c=await a.getInfoByLocation(l,!0,(null===(i=o.country)||void 0===i?void 0:i.stageRootPath)||"");if(c){let{data:{results:t}}=c;if(t&&t[0]){let n=s.countries.find(e=>e.isoCountryCode===t[0].countryCode);if(n){if((null===(r=o.country)||void 0===r?void 0:r.stageRootPath)===n.stageRootPath)e&&e({selectedLocationInfo:{coordinates:l},refreshPage:!1,errorCallback:null});else if(n.isMultiLanguage){this.showErrorMessage("error.multilanguage-geolocation-fallback");return}else e&&e({selectedLocationInfo:{selectedLocation:{country:n,includeNearbyStores:!1},coordinates:l},refreshPage:!0,errorCallback:null})}}else this.showErrorMessage()}}catch(t){this.showErrorMessage()}}showErrorMessage(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"error.unable-to-get-geolocation",{locationSelectorData:{i18n:e}}=this.props;alert(e.value(t))}applyButtonClick(t,e){var o,s,n;let{onLocationChangedCallback:a,locationSelectorData:{locationData:i},setShowButton:r}=this.props;(null===(o=t.store)||void 0===o?void 0:o.storeNum)!==(null===(s=i.store)||void 0===s?void 0:s.storeNum)&&r(!1),a&&a({selectedLocationInfo:{selectedLocation:t},refreshPage:"object"==typeof t.country&&(null===(n=i.country)||void 0===n?void 0:n.stageRootPath)!==t.country.stageRootPath,errorCallback:t=>{r(!0),e(t)}})}}var N=o(70174),I=o(72679),T=o(2731),R=o(82099),A=o(17346),O=o(31966);o(52347);let P=(0,i.forwardRef)((t,e)=>{let{userLocation:o,locationUpdateStrategy:s,controlsVisibility:n,shouldConcreteStoreBeSelected:l,disabled:c,isStoreSpecific:d,resetAccessibilityFocus:u}=t,[h,g]=(0,i.useState)(!0),p=(0,R.Z)(),S=(0,A.Z)(),v=(0,T.Z)(),y=(0,O.Z)(),f=(0,r.useRouter)(),E=(0,m.j)()?window.sessionStorage:new I.gj,L=new N.xg(E),b=new N.ps(p,y,L),C={...v.getInfoByUserLocation(o)};return(0,i.useEffect)(()=>{g(!0)},[o]),(0,a.jsx)(_,{ref:e,isStoreSpecific:d,disabled:c,locationUpdateStrategy:s,shouldConcreteStoreBeSelected:l,controlsVisibility:n,locationSelectorData:{locationData:C,i18n:S,sessionStorage:L,mapkitDataService:b,config:p,allStores:v,router:f},showButton:h,setShowButton:t=>g(t),resetAccessibilityFocus:u})});P.displayName="LocationSelector";class _ extends i.PureComponent{render(){var t=this;let{shouldConcreteStoreBeSelected:e,controlsVisibility:o,disabled:s,isStoreSpecific:n,locationSelectorData:i,showButton:r,setShowButton:l}=this.props,{errorMessage:c,locationModalIsOpen:d}=this.state;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u,{isLoading:this.state.myLocationLoading,shouldConcreteStoreBeSelected:e,isStoreSpecific:n,onClick:()=>this.showModal(),disabled:s,locationSelectorData:i,showButton:r}),(0,a.jsx)(C,{shouldConcreteStoreBeSelected:e,controlsVisibility:o,errorMessage:c,onLocationChangedCallback:function(){for(var e=arguments.length,o=Array(e),s=0;s<e;s++)o[s]=arguments[s];return t.onLocationChangedCallback(...o)},type:h.w8.STANDARD,onClose:()=>this.closeModal(),isOpened:d,onStartLoading:()=>this.onStartLoading(),onEndLoading:()=>this.onEndLoading(),locationSelectorData:i,setShowButton:t=>l(t)})]})}showModal(){this.setState({locationModalIsOpen:!0})}onEndLoading(){this.setState({myLocationLoading:!1})}onStartLoading(){this.setState({myLocationLoading:!0})}onLocationChangedCallback(t){let{selectedLocationInfo:e,refreshPage:o,errorCallback:s}=t,{locationUpdateStrategy:n,onLocationChange:a,locationSelectorData:{router:i}}=this.props;a&&a(),n.onLocationChangedCallback({selectedLocationInfo:e,refreshPage:o,closeCallback:()=>this.closeModal(),errorCallback:s?t=>s(t):null,router:i})}closeModal(){this.state.locationModalIsOpen&&this.setState({locationModalIsOpen:!1}),this.props.resetAccessibilityFocus&&this.props.resetAccessibilityFocus()}constructor(t){super(t),this.state={locationModalIsOpen:!1,myLocationLoading:!1,errorMessage:null}}}_.defaultProps={disabled:!1,onLocationChange:()=>void 0}},8877:function(t,e,o){"use strict";let s;o.r(e),o.d(e,{Operation:function(){return l},Sticky:function(){return p}});var n,a,i,r,l,c,d=o(33509),u=o(57437),h=o(2265),g=o(35088),m=o(70174);o(74538),(n=r||(r={})).INITIAL="initial",n.STICK="stick",n.RELEASE="release",(a=l||(l={})).ADD="add",a.SUBTRACT="sub",(i=c||(c={})).TOP="top",i.BOTTOM="bottom";class p extends h.PureComponent{getBodyScrollTop(){return(this.document.scrollingElement||this.documentElement).scrollTop}getElementRect(t){let e=this.document.querySelector(t);return e?e.getBoundingClientRect():0}initial(){this.setState({status:"initial"})}stick(t){this.setState({status:"stick",position:t})}release(t){this.setState({status:"release",position:t-this.state.stickBoundary})}onScroll(){if(this.mounted){this.scrollTop=this.getBodyScrollTop();let t=this.scrollTop+this.state.top,e=this.scrollTop+this.state.bottom;t<=this.state.stickBoundary?this.initial():e>=this.state.releaseBoundary?this.release(this.state.releaseBoundary-this.state.height):this.stick(this.state.top)}}getReleaseBoundary(){let t;let{releaseSiblingTop:e,releaseSiblingBottom:o,targetHeightOffset:s}=this.props;if(e){let o=this.getElementRect(e).top;o||this.queryInterval(e,"top"),t=this.scrollTop+o}if(o){let e=this.getElementRect(o).bottom;e||this.queryInterval(o,"bottom"),t=this.scrollTop+e}if(s){let e=this.document.querySelector(s.selector);if(e){let o=e.getBoundingClientRect();switch(s.set){case"add":t+=o.height;break;case"sub":t-=o.height}}}return t}setComponentProperties(){let t=this.containerElement.getBoundingClientRect(),e=this.innerElement.getBoundingClientRect(),o=t.width,s=e.height,n=this.getReleaseBoundary(),a=t.top+this.scrollTop;this.setState({top:0,bottom:Math.min(this.state.top+s,this.windowHeight),width:o,height:s,releaseBoundary:n,stickBoundary:a})}queryInterval(t,e){let o=0;this.interval=this.createInterval(1e3,()=>{o<5?(o++,this.getElementRect(t)[e]&&(this.setComponentProperties(),this.clearInterval(this.interval))):this.clearInterval(this.interval)})}createInterval(t,e){return window?window.setInterval(e,t):setInterval(e,t)}clearInterval(t){"number"==typeof t?window.clearInterval(t):clearInterval(t)}componentDidMount(){this.mounted=!0,this.document=document,this.documentElement=document.documentElement,this.windowHeight=window.innerHeight||this.documentElement.clientHeight,this.scrollTop=this.getBodyScrollTop(),this.browserService=this.getBrowserService(),this.browserService.subscribeScrollEvent(this.onScroll),this.setComponentProperties(),this.localeSwitcherMutationObserver=new MutationObserver(t=>{let e="ac-ls-visible";t.forEach(t=>{let{target:o,oldValue:s}=t;o.nodeType===Node.ELEMENT_NODE&&t.target.className.includes(e)!==s.includes(e)&&this.setComponentProperties()})}),this.localeSwitcherMutationObserver.observe(document.documentElement,{attributes:!0,attributeOldValue:!0,attributeFilter:["class"]})}componentDidUpdate(t,e){if(this.props.enablePropertyUpdates){let t=this.containerElement.getBoundingClientRect(),o=this.innerElement.getBoundingClientRect(),s=t.width,n=o.height,a=this.getReleaseBoundary(),i=t.top+this.scrollTop;s!==e.width&&this.setState({width:s}),n!==e.height&&this.setState({height:n}),a!==e.releaseBoundary&&this.setState({releaseBoundary:a}),i!==e.stickBoundary&&this.setState({stickBoundary:i})}}componentWillUnmount(){var t;this.mounted=!1,this.clearInterval(this.interval),null===(t=this.browserService)||void 0===t||t.unsubscribeScrollEvent(this.onScroll),this.localeSwitcherMutationObserver.disconnect()}render(){let{initialHeight:t}=this.props,e="sticky-".concat(this.state.status),o="".concat(this.props.forceDOMFlow?this.state.height:t,"px"),s=this.state.position+"px",n={top:"release"===this.state.status?s:"0px",zIndex:this.props.zIndex||2};return(0,u.jsx)("div",{ref:t=>{this.containerElement=t},style:{height:o},children:(0,u.jsx)("div",{className:"sticky-element ".concat(e),ref:t=>{this.innerElement=t},style:n,children:this.props.children})})}constructor(t){super(t),this.getBrowserService=()=>s||(s=new m.qD),this.document=null,this.documentElement=null,this.windowHeight=0,this.scrollTop=0,this.mounted=!1,this.interval=0,this.browserService=null,this.containerElement=null,this.innerElement=null,this.localeSwitcherMutationObserver=null;let{initialHeight:e}=this.props;this.state={top:0,bottom:0,height:e||0,width:0,stickBoundary:0,releaseBoundary:1/0,status:"initial",position:0}}}p.defaultProps={initialHeight:0},(0,d.__decorate)([g.m],p.prototype,"onScroll",null),(0,d.__decorate)([g.m],p.prototype,"createInterval",null),(0,d.__decorate)([g.m],p.prototype,"clearInterval",null)},90061:function(t,e,o){"use strict";o.d(e,{Z:function(){return g}});var s=o(2265),n=o(99376),a=o(70174),i=o(38452);class r{async actualizeLocation(t,e,o){return e?this.prioritizeSessionStorage(t,o):this.prioritizeUrl(t)}updateUserLocationOnResponse(t,e){if(e&&e.storeNum&&(t.courseSlug&&this.sessionStorage.getLocationLabelInfo()||this.sessionStorage.setLocationLabelInfo(e),!(this.sessionStorage.getUserLocation()||this.sessionStorage.getSelectedStoreLocation()))){let{store:{lat:t,long:o}={lat:null,long:null}}=this.allStores.getInfoByUserLocation(e)||{};null!==t&&null!==o&&this.sessionStorage.setUserLocation({lat:t,long:o})}}isGenericEventPageWithSpecifiedStore(t){return!!(t.courseSlug&&!t.scheduleId&&t[i.az.STORE_NUMBER])}async prioritizeSessionStorage(t,e){if(t[i.az.SELECTED_STORE]){let e=JSON.parse(t[i.az.SELECTED_STORE]);return this.sessionStorage.updateLocationToSelectedByStore({storeNum:e.storeNum,locale:e.locale,slug:e.slug},!1),{selectedStore:this.sessionStorage.getSelectedStoreLocation(),nearby:!1}}let o=this.sessionStorage.getSelectedStoreLocation(),s=this.sessionStorage.getSelectedMarket();if(this.isStageRootPathValid(t,o,s)||(o=null,s=null,this.sessionStorage.removeLocationLabelInfo(),this.sessionStorage.removeSelectedStoreLocation()),this.isGenericEventPageWithSpecifiedStore(t)){var n,a;let e=this.allStores.getStoreByStoreNumber((0,i._V)(t.stageRootPath),t[i.az.STORE_NUMBER]);return this.sessionStorage.updateLocationToSelectedByStore({storeNum:(null==e?void 0:null===(n=e.store)||void 0===n?void 0:n.storeNum)||"",locale:this.locale.id,slug:(null==e?void 0:null===(a=e.store)||void 0===a?void 0:a.slug)||""},!1),{selectedStore:this.sessionStorage.getSelectedStoreLocation(),nearby:!1}}if(o)return{selectedStore:o,nearby:this.sessionStorage.getNearbyFlag()};if(s)return{marketSlug:s};{let o=this.sessionStorage.getUserLocation();return o||e||(o=await this.updateUserCoordinates(!1,t.stageRootPath)),{userLocation:o}}}async prioritizeUrl(t){let{storeSlug:e,marketSlug:o}=t,s=!e&&o?"area":e;if(s){if(o)return this.sessionStorage.updateLocationToSelectedByMarket(o),{marketSlug:o};{var n;let o="true"===t[i.az.NEAR_BY],a=this.allStores.getStoreByStoreSlug(this.locale.stageRootPath,s),r={slug:e,storeNum:(null==a?void 0:null===(n=a.store)||void 0===n?void 0:n.storeNum)||"",locale:this.locale.id};return this.sessionStorage.updateLocationToSelectedByStore(r,o),{selectedStore:r,nearby:o}}}{let e=this.sessionStorage.getUserLocation();return e||(e=await this.updateUserCoordinates(!!t[i.az.USE_MY_LOCATION],this.locale.stageRootPath)),{userLocation:e}}}async updateUserCoordinates(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;try{await this.mapkitDataService.getMyIpLookup(!1,e)}catch(t){this.logger.error("MapKit Error -> LocationService -> updateUserCoordinates: ".concat(t))}let o=this.sessionStorage.getUserLocation();return this.sessionStorage.updateLocationToSelectedByCoordinates(o,t),o}isStageRootPathValid(t,e,o){let{}=this,s=(0,i._V)(t.stageRootPath?t.stageRootPath:"");if(e&&e.locale){if(s!==this.allStores.countriesMap[e.locale].stageRootPath)return!1}else if(o){let t=this.sessionStorage.getLocationLabelInfo();if(t&&t.locale&&s!==this.allStores.countriesMap[t.locale].stageRootPath)return!1}return!0}constructor(t,e,o,s,n){this.sessionStorage=t,this.mapkitDataService=e,this.allStores=o,this.locale=s,this.logger=n}}var l=o(2731),c=o(24809),d=o(82099),u=o(31966),h=o(47965);function g(t,e){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],g=arguments.length>3&&void 0!==arguments[3]&&arguments[3],m=(0,d.Z)(),p=(0,l.Z)(),{currentLocale:S}=(0,c.Z)(),v=(0,u.Z)(),y=(0,h.Z)(),f=(0,n.usePathname)(),E=(0,n.useSearchParams)(),L=(0,s.useMemo)(()=>new a.ps(m,v,y),[m,v,y]),b=(0,s.useMemo)(()=>new r(y,L,p,S,v),[p,S,v,L,y]),[C,N]=(0,s.useState)(null),I=o||!!/.*\/today\/camp\/?$/i.test(f)&&E.get(i.az.STATUS)===i.K.THANK_YOU;return(0,s.useEffect)(()=>{(async()=>{N(await b.actualizeLocation(t,I,g))})()},[b,t,I,g]),(0,s.useEffect)(()=>{b.updateUserLocationOnResponse(t,e)},[b,t,e]),{locationServiceData:C}}},85075:function(t,e,o){"use strict";o.d(e,{Z:function(){return d}});var s=o(2265),n=o(17346),a=o(24809),i=o(82099),r=o(31966),l=o(47965),c=o(16799);function d(t,e){let o=(0,n.Z)(),d=(0,i.Z)(),u=(0,r.Z)(),h=(0,l.Z)(),{allLocalesService:g}=(0,a.Z)(),m=(null==e?void 0:e.locationUpdateStrategy)||c.lx,p=(0,s.useCallback)(async t=>{let{routeParams:o,queryParams:s,location:n,refreshPage:a}=t;(null==e?void 0:e.updatePageData)&&await e.updatePageData({routeParams:o,queryParams:s,location:n,refreshPage:a})},[e]);return(0,s.useMemo)(()=>new m({i18n:o,sessionStorage:h,allLocales:g,pageName:t,logger:u,configManager:d,match:e.match,actions:{callbackBeforeModalCloses:p}}),[m,o,h,g,t,u,d,e.match,p])}},10357:function(t,e,o){"use strict";o.d(e,{Z:function(){return a}});var s=o(2265),n=o(47965);function a(t,e){let[o,a]=(0,s.useState)(!1),i=(0,n.Z)(),r=i.getSelectedStoreLocation();return(0,s.useEffect)(()=>{let o=i.getSelectedMarket();a(!!(t&&e||!t&&o||!t&&r))},[e,i,r,t]),o}},98689:function(t,e,o){"use strict";var s,n,a,i;o.d(e,{b:function(){return n},r:function(){return s}}),(a=s||(s={})).STORE_NUMBER="storeNumber",a.DATE="date",a.START_TIME="startTime",a.IS_YOUTH="isYouth",a.MAX_ATTENDEE="maxAttendee",(i=n||(n={})).FIELD_TRIP="fieldtrip",i.TOPICS="topics",i.DURATIONS="durations",i.SESSION="session",i.ERROR="error"},58679:function(t,e,o){"use strict";o.d(e,{b:function(){return r}});var s=o(93213),n=o(83321),a=o(38452),i=o(89);class r extends n.f{getPageData(t,e,o){return this._getPageData(t,e,o)}_getPageData(t,e,o){let{courseSlug:n,scheduleId:r}=t,{nearby:l}=e,c={courseSlug:n,scheduleId:r,stageRootPath:(0,a._V)(t.stageRootPath),...o},d=(0,i.TF)(c,e),{normalizedRouteParams:u,normalizedQueryParams:h}=(0,i.rg)(d,c,e),g={...h,...u},m=this.getTypifiedApiUrl(()=>d)(s.q.EVENT,u,h);return this.getData(m,g,"EventPageResponse",t=>(0,i.FV)(r,t),s.q.EVENT)}}},9200:function(t,e,o){"use strict";o.d(e,{U:function(){return l}});var s=o(93213),n=o(44521),a=o(38452),i=o(83321),r=o(89);class l extends i.f{getPageData(t,e,o){return this._getPageData(t,e,o)}async getGroupBookingHasSessions(t,e){let o=this.getDeepLinkingParams(t,e),n=(0,a._V)(t.stageRootPath),i={...o,stageRootPath:n,hasSessions:!0},l=this.getTypifiedApiUrl(r.vf)(s.q.GROUP_BOOKING,t,e);try{let{data:t}=await this.transport.get(l,{params:i});return t.hasSessions||!1}catch(t){return this.logger.error("Error occurred: AppDataService -> getGroupBookingHasSessions"),null}}async getGroupBookingSessionInfo(t,e,o){let n=this.getDeepLinkingParams(t,e,o),i=(0,a._V)(t.stageRootPath),l=t.courseId,c={...n,stageRootPath:i,courseId:l},d=this.getTypifiedApiUrl(r.vf)(s.q.GROUP_BOOKING_SESSION_INFO,t,e);try{let{data:t}=await this.transport.get(d,{params:c});return(0,r.aK)(t)}catch(t){return this.logger.error("Error occurred: AppDataService -> getGroupBookingSessionInfo"),null}}_getPageData(t,e,o){let i=this.getDeepLinkingParams(t,e,o),l=(0,a._V)(t.stageRootPath),c={...i,stageRootPath:l},d=this.getTypifiedApiUrl(r.vf)(s.q.GROUP_BOOKING,t,e),u=(0,n.j)()?(0,a.Y2)(window.location.search):e;return this.getData(d,c,"GroupBookingPageResponse",t=>(0,r.WQ)(t,u),s.q.GROUP_BOOKING)}}},15351:function(t,e,o){"use strict";o.d(e,{I5:function(){return r},iI:function(){return i},XY:function(){return d},AN:function(){return l}});var s=o(93213),n=o(38452),a=o(80777);class i{processBffError(t,e,o){let s=this.getLandingUrl(e),a=this.getNearBy(e);this.redirect((0,n.d_)(s,a))}getNearBy(t){let e=new URLSearchParams;return"true"===t.queryParams[n.az.NEAR_BY]&&e.set(n.az.NEAR_BY,"true"),e}getLandingUrl(t){let e=(0,n.$r)(this.configManager,t.routeParams.stageRootPath);return(0,n.Vf)(this.configManager.getPageRoute(s.q.DISCOVER),{...t.queryParams,...t.routeParams,[a.kv.STAGE_ROOT_PATH]:e})}constructor(t,e){this.configManager=t,this.redirect=(null==e?void 0:e.redirect)||(t=>{}),this.error=(null==e?void 0:e.error)||(()=>{})}}class r extends i{processBffError(t,e,o){let i=t.response.data,r=new URLSearchParams,l=i[a.kv.COURSE_SLUG]===a.tx.PARAM_IS_WRONG,c=i[a.kv.SCHEDULE_ID]===a.tx.PARAM_IS_WRONG;if(l||c){let t=l?n.K.COURSE_NOT_FOUND:n.K.SESSION_NOT_FOUND;r.set(n.az.ERROR,t);let o=(0,n.$r)(this.configManager,e.routeParams.stageRootPath),i=(0,n.Vf)(this.configManager.getPageRoute(s.q.CONFIRMATION_ERROR),{...e.queryParams,...e.routeParams,[a.kv.STAGE_ROOT_PATH]:o,scheduleId:void 0});this.redirect((0,n.d_)(i,r))}else super.processBffError(t,e,o)}}class l extends i{processBffError(t,e,o){t.response||super.processBffError(t,e,o);let i=t.response.data,r=new URLSearchParams;if(i[a.kv.COURSE_SLUG]===a.tx.PARAM_IS_WRONG){r.set(n.az.ERROR,n.K.COURSE_NOT_FOUND);let t=this.getLandingUrl(e);this.redirect((0,n.d_)(t,r))}if(i[a.kv.SCHEDULE_ID]===a.tx.PARAM_IS_WRONG){r.set(n.az.ERROR,n.K.SESSION_NOT_FOUND);let t=(0,n.$r)(this.configManager,e.routeParams.stageRootPath),o=(0,n.Vf)(this.configManager.getPageRoute(s.q.EVENT),{...e.queryParams,...e.routeParams,[a.kv.STAGE_ROOT_PATH]:t,scheduleId:void 0});this.redirect((0,n.d_)(o,r))}super.processBffError(t,e,o)}}var c=o(62998);class d extends i{processBffError(t,e,o){t.response&&t.response.status===c.d.INTERNAL_SERVER_ERROR?this.error():t&&(o.error("Unknown Error: ".concat(t)),this.error()),super.processBffError(t,e,o)}}o(55777)},80777:function(t,e,o){"use strict";o.d(e,{IG:function(){return i},tx:function(){return s.tx},kv:function(){return s.kv}});var s=o(55777),n=o(99376),a=o(15351);class i{applyFallbackStrategy(t){let{error:e,request:o,page:s,url:i,logger:r}=t;if(r){let t={params:o.routeParams,query:o.queryParams,page:s,url:i};e.message&&(t.errorMessage=e.message),e.stack&&(t.errorStack=e.stack),r.error("".concat(s," page pageData error - fallback strategy invoked - see Fallback Error Object for more info")),r.info("Fallback Error Object: ",t)}if(e.response&&e.response.data){let t=e.response.data;this.isParamInvalid(t,r)&&(0,n.notFound)()}(this.pageSpecificMappings?this.pageSpecificMappings:new a.iI(this.configManager,{redirect:this.redirect})).processBffError(e,o,r)}isParamInvalid(t,e){return t[s.kv.STAGE_ROOT_PATH]===s.tx.PARAM_IS_INVALID||t[s.kv.STAGE_ROOT_PATH]===s.tx.PARAM_IS_WRONG?(e.error("Invalid ".concat(s.kv.STAGE_ROOT_PATH," - returned as ").concat(t[s.kv.STAGE_ROOT_PATH])),!0):t[s.kv.STORE_SLUG]===s.tx.PARAM_IS_WRONG||"string"==typeof t&&-1!==t.indexOf(s.uf)?(e.error("Invalid ".concat(s.kv.STORE_SLUG," - returned as ").concat(t[s.kv.STORE_SLUG])),!0):t[s.kv.MARKET_SLUG]===s.tx.PARAM_IS_WRONG||"string"==typeof t&&-1!==t.indexOf(s.uf)?(e.error("Invalid ".concat(s.kv.MARKET_SLUG," - returned as ").concat(t[s.kv.MARKET_SLUG])),!0):void 0}constructor(t,e,o){this.pageSpecificMappings=e,this.configManager=t,this.redirect=(null==o?void 0:o.redirect)||(t=>{})}}},55777:function(t,e,o){"use strict";var s,n,a,i;o.d(e,{kv:function(){return n},tx:function(){return s},uf:function(){return r}});let r="com.apple.interactive.retail.today.bff.services.domain.StoreNotFoundException";(a=s||(s={})).PARAM_IS_MISSING="PARAM_IS_MISSING",a.PARAM_IS_INVALID="PARAM_IS_INVALID",a.PARAM_IS_WRONG="PARAM_IS_WRONG",(i=n||(n={})).STAGE_ROOT_PATH="stageRootPath",i.URL_STAGE_ROOT_PATH="urlStageRootPath",i.MARKET_SLUG="marketSlug",i.STORE_SLUG="storeSlug",i.COURSE_SLUG="courseSlug",i.SCHEDULE_ID="scheduleId",i.SESSION_ID="sessionId",i.COLLECTION_SLUG="collectionSlug",i.LAT="lat",i.LONG="long",i.LOCALE="locale",i.PAGE="page"},65667:function(t,e,o){"use strict";o.d(e,{O:function(){return n}});let s={"/au":"AU","/ca":"CA","/ca/fr":"CA","/at":"AT","/befr":"BE","/benl":"BE","/fr":"FR","/de":"DE","/it":"IT","/nl":"NL","/es":"ES","/se":"SE","/chde":"CH","/chfr":"CH","/uk":"GB","/cn":"CN","/mo":"CN","/hk/en":"HK","/hk":"HK","/tw":"TW","/jp":"JP","/br":"BR","/mx":"MX","/ae":"AE","/sg":"SG","/th":"TH","/kr":"KR","/tr":"TR","/in":"IN","/my":"MY","":"US"};function n(t,e){let o=s[t],n=e&&e.countryCode&&e.countryCode.toUpperCase();return!!o&&!!n&&o!==n}},38088:function(t,e,o){"use strict";o.d(e,{s:function(){return s}});let s=t=>{let{storeSlug:e,marketSlug:o}=t;return!e&&!o}},86813:function(){},64400:function(){},95650:function(){},52347:function(){},2652:function(){},74538:function(){}}]);