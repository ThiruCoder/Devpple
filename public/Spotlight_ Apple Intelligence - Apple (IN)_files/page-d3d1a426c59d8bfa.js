(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5883,8333,1633],{25969:function(e){"use strict";e.exports=require("@marcom/ac-analytics")},97206:function(e,r,a){Promise.resolve().then(a.bind(a,40323)),Promise.resolve().then(a.bind(a,64551)),Promise.resolve().then(a.bind(a,35660)),Promise.resolve().then(a.bind(a,74614)),Promise.resolve().then(a.bind(a,8877)),Promise.resolve().then(a.bind(a,14125))},35660:function(e,r,a){"use strict";a.r(r),a.d(r,{CampRegistration:function(){return Z}});var s,t,i,l,n=a(57437),o=a(2265),c=a(99376),m=a(93213),d=a(8435),u=a(64181),g=a(68999),h=a(3956),f=a(79384);class p{async getWorkshopStatus(e){return this.registrationDataService.getWorkshopStatus(e)}async initiateWorkflow(e){let r=null,a=null,s=null;try{let{localeId:r}=e;a=await this.registrationDataService.getReservationsHistory(r)}catch(e){a=null,this.logger.error("Error occurred: CampWorkflowDataService -> initiateWorkflow -> getReservationsHistory")}if(a)try{r=await this.registrationDataService.lockSession(e)}catch(e){r=null,s=(0,u.wY)(e,this.ERROR_KEYS),this.logger.error("Error occurred: CampWorkflowDataService -> initiateWorkflow -> lockSession")}return{lock:r,reservations:a,error:s}}async createReservation(e){let r=null;try{r=await this.registrationDataService.createReservation(e)}catch(a){if((r=(0,u.fX)((0,u.wY)(a,this.ERROR_KEYS))).status!==g.J.FORBIDDEN)try{let a=await this.registrationDataService.getWorkshopStatus(e);e.schedule.status!==h.N.WAITLIST&&a.eventStatus===g.J.WAITLIST&&(r=(0,u.fX)(g.J.NON_RSVP))}catch(e){this.logger.error("Error occurred: CampWorkflowDataService -> createReservation -> createReservation")}}return{reservation:r,reservations:void 0}}constructor(e,r){this.registrationDataService=e,this.logger=r,this.ERROR_KEYS=f.$}}var N=a(38452),v=a(82538),b=a(2731),x=a(686),R=a(82099),S=a(17346),y=a(24809),j=a(31966),_=a(50432),L=a(90061),E=a(92453),T=a(84772),w=a.n(T),I=a(50209),k=a(44521),O=a(73440);a(1225);let C={acknowledgment:{isTouched:!1,isValid:!1}},D=e=>{let{onFieldChange:r,isTouched:a}=e,s=(0,S.Z)(),[t,i]=(0,o.useState)(C),l=s.value("registration-form.camp-guardian-terms-conditions"),c=s.value("registration-form.camp-guardian-permission");"".concat(c," ").concat(l.replace(/(<([^>]+)>)/gi,""));let m=w()("form-element",{"is-error":(a||t.acknowledgment.isTouched)&&!t.acknowledgment.isValid});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("legend",{className:"typography-label permission-section-legend",id:"form-label",children:s.value("registration-form.guardian-acknowledgment")}),(0,n.jsxs)("div",{className:"permission-section",children:[(0,n.jsx)("p",{className:"typography-body permission-intro",children:c}),(0,n.jsx)("div",{className:"pattern-checkbox",children:(0,n.jsx)("div",{className:"form-table",children:(0,n.jsx)("div",{className:"form-row",children:(0,n.jsx)("div",{className:"form-cell",children:(0,n.jsxs)("div",{className:m,children:[(0,n.jsxs)("div",{className:"acknowledgement form-checkbox",children:[(0,n.jsx)("input",{type:"checkbox",id:"guardian_acknowledgment",name:"guardianAcknowledgement",className:"form-checkbox-input",required:!0,"aria-labelledby":"guardian_acknowledgment_label","aria-describedby":m.includes("is-error")?"guardian_acknowledgment_terms_error":"",onChange:e=>{let a=e.currentTarget.checked;t.acknowledgment.isTouched||i(e=>({...e,acknowledgment:{...e.acknowledgment,isTouched:!0}})),i(e=>({...e,acknowledgment:{...e.acknowledgment,isValid:a}})),r(e)}}),(0,n.jsxs)("label",{className:"form-label",htmlFor:"guardian_acknowledgment","aria-hidden":"true",id:"guardian_acknowledgment_label",children:[(0,n.jsx)("span",{className:"form-checkbox-indicator aligned"}),(0,n.jsx)("span",{dangerouslySetInnerHTML:{__html:l}})]})]}),(0,n.jsx)("div",{className:"form-message-wrapper",id:"guardian_acknowledgment_terms_error",children:(0,n.jsx)("span",{className:"form-message",children:s.value("registration-form.error-camp-terms")})})]})})})})})]})]})};a(71402);let W=e=>{let{isFirstNameFirst:r,onFieldChange:a,onSubmit:s,isTouched:t,isSubmitting:i}=e,l=(0,S.Z)(),o=(0,n.jsx)(O.Wi,{id:"guardian_name_first",name:"firstName",flyout:l.value("registration-form.guardian-name-first"),errorMessage:l.value("registration-form.error-guardian-name-first"),required:!0,onChange:a,isTouched:t,pattern:I.qT}),c=(0,n.jsx)(O.Wi,{id:"guardian_name_last",name:"lastName",flyout:l.value("registration-form.guardian-name-last"),errorMessage:l.value("registration-form.error-guardian-name-last"),required:!0,onChange:a,isTouched:t,pattern:I.qT}),d=w()("pill","pill-large","pill-active","agree-send-button",{"pill-disabled":i});return(0,n.jsx)("section",{className:"section section-ack-form",children:(0,n.jsx)("div",{className:"section-content",children:(0,n.jsx)("div",{className:"row",children:(0,n.jsx)("div",{className:"column large-11 large-offset-1 small-10",children:(0,n.jsxs)("div",{className:"form-table has-label",children:[(0,n.jsxs)("fieldset",{className:"user-ack-form",children:[(0,n.jsx)(D,{i18n:l,onFieldChange:a,isTouched:t}),(0,n.jsx)("p",{className:"typography-label user-ack-form-intro",children:l.value("registration-form.acknowledged")}),!r&&c,o,r&&c,(0,n.jsx)(O.Wi,{autoCapitalize:m.Uc.OFF,errorMessage:l.value("registration-form.error-guardian-email"),flyout:l.value("registration-form.email"),id:"guardian_email",name:"email",pattern:I.Qs,required:!0,type:m.EI.EMAIL,onChange:a,isTouched:t}),(0,n.jsx)(O.Wi,{errorMessage:l.value("registration-form.error-guardian-phone"),flyout:l.value("registration-form.phone"),id:"guardian_phone",inputMode:m._H.NUMERIC,name:"phone",pattern:I.iw,required:!0,type:m.EI.TEL,onChange:a,isTouched:t})]}),(0,n.jsx)("div",{className:"form-agree-send",children:(0,n.jsx)("div",{className:"form-row",children:(0,n.jsx)("div",{className:"form-cell submit-button-cell",children:(0,n.jsx)("button",{id:"agree-send-button",className:d,onClick:s,disabled:i,children:l.value("registration-form.agree-send")})})})})]})})})})})};a(73307);let M=e=>{let{storeTitle:r,courseName:a,programName:s,isMultiLanguage:t,lang:i,sessions:l}=e,o=(0,S.Z)();return(0,n.jsx)("section",{className:"section section-registration-details",children:(0,n.jsxs)("div",{className:"section-content",children:[(0,n.jsx)("div",{className:"row register-intro",children:(0,n.jsxs)("div",{className:"column large-11 large-offset-1 small-10 register-typography-header",children:[(0,n.jsx)("p",{className:"typography-section-eyebrow eyebrow column large-12",children:o.value("registration-form.sign-up")}),(0,n.jsxs)("h1",{className:"typography-headline-reduced column large-8 medium-8 small-12",children:[s&&"".concat(s).concat(o.value("global.program-schedule-separator")),a,t&&i&&(0,n.jsxs)(n.Fragment,{children:[" "+o.value("global.delivery-language-open-punctuation"),(0,n.jsx)("span",{className:"delivery-language",children:o.value("language.".concat(i))}),o.value("global.delivery-language-close-punctuation")]})]}),(0,n.jsx)("p",{className:"typography-body description column large-8 medium-12",children:o.value("registration-form.camp-description")})]})}),(0,n.jsx)("div",{className:"row",children:(0,n.jsxs)("div",{className:"column large-7 large-offset-1 medium-11 small-10",children:[a&&(0,n.jsxs)("div",{className:"program-info row column large-12",children:[(0,n.jsx)("p",{className:"large-4 small-12 column register-info register-label",children:o.value("registration-form.program")}),(0,n.jsx)("p",{className:"large-8 small-12 column register-info register-info-title typography-body",children:a})]}),(0,n.jsxs)("div",{className:"large-12 row column schedule-info",children:[(0,n.jsx)("p",{className:"large-4 small-12 column register-info register-label",children:o.value("registration-form.date-time")}),(0,n.jsx)("div",{className:"large-8 small-12 column register-info register-info-schedule typography-body",children:l&&l.length&&(0,n.jsx)("ul",{className:"register-info-schedule-list",children:l.map((e,r)=>{let{fullDate:a}=e;return(0,n.jsx)("li",{children:a},r)})})})]}),r&&(0,n.jsxs)("div",{className:"large-12 row",children:[(0,n.jsx)("p",{className:"large-4 small-12 column register-info register-label",children:o.value("registration-form.store")}),(0,n.jsx)("p",{className:"large-8 small-12 column register-info register-info-store",children:r})]})]})})]})})};a(21424),(s=i||(i={})).S="Small",s.M="Medium",s.L="Large",(t=l||(l={})).S="S",t.M="M",t.L="L";let P=e=>{let{label:r,size:a,onChange:s,ariaDescribedby:t}=e,l="tShirt".concat(a),o="".concat(l,"_label");return(0,n.jsxs)("li",{className:"form-selector form-selector-threeline column large-4 small-6",children:[(0,n.jsx)("input",{"aria-labelledby":o,className:"form-choice form-selector-input rounded",id:l,name:"tshirtSize",required:!0,type:"radio",value:a,onChange:s,"aria-describedby":t}),(0,n.jsx)("div",{className:"form-selector-label",children:(0,n.jsx)("span",{id:o,"aria-hidden":"true","aria-label":i[a],className:"form-label",children:r})})]})};a(47745);let A={tshirtSize:{isTouched:!1,isValid:!1}},U=e=>{let{onFieldChange:r,isTouched:a,isFirstNameFirst:s}=e,t=(0,S.Z)(),[i,c]=(0,o.useState)(A),d=e=>{i.tshirtSize.isTouched||c(e=>({...e,tshirtSize:{...e.tshirtSize,isTouched:!0}}));let{value:a}=e.currentTarget,s=!!a.trim();c(e=>({...e,tshirtSize:{...e.tshirtSize,isValid:s}})),r(e)},u=(0,n.jsx)(O.Wi,{id:"camper_name_first",className:"camper-name-first",name:"childFirstName",flyout:t.value("registration-form.child-name-first"),errorMessage:t.value("registration-form.error-child-name-first"),required:!0,onChange:r,isTouched:a,pattern:I.qT}),g=(0,n.jsx)(O.Wi,{id:"camper_name_last",name:"childLastName",flyout:t.value("registration-form.child-name-last"),errorMessage:t.value("registration-form.error-child-name-last"),required:!0,onChange:r,isTouched:a,pattern:I.qT}),h=(0,n.jsx)(O.Wi,{id:"emergency_contact_name_first",name:"emergencyContactFirstName",flyout:t.value("registration-form.name-first"),errorMessage:t.value("registration-form.error-emergency-contact-name-first"),required:!0,onChange:r,isTouched:a,pattern:I.qT}),f=(0,n.jsx)(O.Wi,{id:"emergency_contact_name_last",name:"emergencyContactLastName",flyout:t.value("registration-form.name-last"),errorMessage:t.value("registration-form.error-emergency-contact-name-last"),required:!0,onChange:r,isTouched:a,pattern:I.qT}),p=w()("selector-section",{"is-error":(a||i.tshirtSize.isTouched)&&!i.tshirtSize.isValid});return(0,n.jsx)("section",{className:"section section-registration-form",children:(0,n.jsx)("div",{className:"section-content",children:(0,n.jsx)("div",{className:"row",children:(0,n.jsx)("div",{className:"column large-11 large-offset-1 small-10",children:(0,n.jsxs)("div",{className:"form-table has-label",children:[(0,n.jsxs)("fieldset",{className:"user-camper-information",children:[(0,n.jsx)("legend",{className:"typography-label",children:t.value("registration-form.camp-camper-information")}),!s&&g,u,s&&g]}),(0,n.jsx)("div",{className:"user-tshirt-size row",children:(0,n.jsx)("div",{className:"form-row column large-7 medium-10 small-12 radio-button-group",children:(0,n.jsx)("div",{className:"pattern-selectors",children:(0,n.jsxs)("fieldset",{className:p,children:[(0,n.jsx)("legend",{className:"typography-label",children:t.value("registration-form.tshirt-size")}),(0,n.jsx)("p",{className:"shirt-intro typography-body large-10",children:t.value("registration-form.camp-complementary-shirt")}),(0,n.jsxs)("ul",{className:"form-selector form-selector-group-withgutters row",children:[(0,n.jsx)(P,{size:l.S,label:t.value("registration-form.size-s"),onChange:d,ariaDescribedby:p.includes("is-error")?"user-tshirt-size_error":""},l.S),(0,n.jsx)(P,{size:l.M,label:t.value("registration-form.size-m"),onChange:d,ariaDescribedby:p.includes("is-error")?"user-tshirt-size_error":""},l.M),(0,n.jsx)(P,{size:l.L,label:t.value("registration-form.size-l"),onChange:d,ariaDescribedby:p.includes("is-error")?"user-tshirt-size_error":""},l.L)]}),(0,n.jsx)("div",{className:"form-message-wrapper",children:(0,n.jsx)("span",{className:"form-message",id:"user-tshirt-size_error",children:t.value("registration-form.error-tshirt-size-youth")})})]})})})}),(0,n.jsx)("p",{className:"sosumi",children:t.value("registration-form.camp-complementary-shirt-disclaimer")}),(0,n.jsxs)("fieldset",{className:"user-emergency-information",children:[(0,n.jsx)("legend",{className:"typography-label",children:t.value("registration-form.emergency-contact")}),!s&&f,h,s&&f,(0,n.jsx)(O.Wi,{type:m.EI.TEL,pattern:I.iw,errorMessage:t.value("registration-form.error-emergency-contact-phone"),flyout:t.value("registration-form.phone"),id:"emergency_contact_phone",name:"emergencyContactPhoneNumber",required:!0,onChange:r,isTouched:a})]})]})})})})})};a(75749);let z={childFirstName:"",childLastName:"",tshirtSize:"",emergencyContactFirstName:"",emergencyContactLastName:"",emergencyContactPhoneNumber:"",guardianAcknowledgement:!1,firstName:"",lastName:"",email:"",phone:""},q=e=>{let{className:r,...a}=e,s=(0,S.Z)(),[t,i]=(0,o.useState)(!1),[l,c]=(0,o.useState)(!1),[m,d]=(0,o.useState)(!1),[u,g]=(0,o.useState)(z),h=(0,o.useRef)(null);(0,o.useEffect)(()=>((0,k.j)()&&document.addEventListener("invalid",N,!0),()=>{document.removeEventListener("invalid",N,!0)}),[]);let f=async()=>{d(!0),l||c(!0),t?d(await (null==a?void 0:a.submit(u))):(p(),d(!1))},p=()=>{let e=h.current;if(!e)return;let r=Object.keys(u).find(e=>!u[e]);e.querySelector("[name=".concat(r,"]")).focus()},N=e=>{e.preventDefault()},v=/^true/i.test(s.value("config.first-name-first")),b=e=>{let{currentTarget:{name:r,type:a,checked:s,value:t}}=e,l="checkbox"===a?s:t.trim(),n={...u,[r]:l};!1===(0,I.Bq)(r,l)&&(n[r]=z[r]);let o=!!l&&Object.keys(n).every(e=>!!n[e]);g(n),i(o)},x=w()("registration-section",r);return(0,n.jsxs)("form",{className:x,ref:h,id:"registration-form-content",onSubmit:e=>{e.preventDefault()},children:[(0,n.jsx)(M,{i18n:s,...a}),(0,n.jsx)(U,{i18n:s,onFieldChange:b,isTouched:l,isFirstNameFirst:v}),(0,n.jsx)(W,{i18n:s,onFieldChange:b,isTouched:l,isFirstNameFirst:v,onSubmit:f,isSubmitting:m})]})};var V=a(31341),F=a(41923);class B{static getMappings(){return{[F.L.WAITLIST_FULL]:{label:"error.camp-waitlist-full",buttons:[B.REDIRECT_ON_ERROR_BUTTON]},[F.L.LIMIT]:{label:"error.camp-limit-reached",buttons:[{...B.REDIRECT_ON_ERROR_BUTTON,text:"global.cta-learn-more"}]},[F.L.IN_PROGRESS]:{label:"error.camp-in-progress",buttons:[B.REDIRECT_ON_ERROR_BUTTON]},[F.L.SESSION_WARNING]:{label:"error.camp-session-timeout-warning",buttons:[B.CLOSE_BUTTON]},[F.L.UNAVAILABLE]:{label:"error.camp-closed",buttons:[B.REDIRECT_ON_ERROR_BUTTON]},[F.L.NON_RSVP]:{label:"error.generic",buttons:[B.CLOSE_BUTTON]},[F.L.ALREADY_RESERVED]:{label:"error.already-reserved-camp",buttons:[B.CLOSE_BUTTON]},[F.L.GENERIC_ERROR]:{label:"error.generic",buttons:[B.CLOSE_BUTTON]}}}}B.CLOSE_BUTTON={text:"global.cta-ok",callback:e=>{let{closeOnErrorCallback:r}=e;r&&r()}},B.REDIRECT_ON_ERROR_BUTTON={text:"global.cta-ok",callback:e=>{let{redirectOnErrorCallback:r}=e;r&&r()}},a(30416);let Z=e=>{let{searchParams:r}=e,{pageData:a,setPageData:s}=(0,_.Z)(),t=(0,b.Z)(),i=(0,R.Z)(),l=(0,S.Z)(),g=(0,j.Z)(),h=(0,c.useRouter)(),{analyticsService:f}=(0,x.Z)(),{currentLocale:T}=(0,y.Z)(),[w,I]=(0,o.useState)(null),[k,O]=(0,o.useState)(null),C=a.userLocation;(0,L.Z)(r,C,!0);let D=(0,E.Z)(T),W=new d.p(i,T,g,f),M=new p(W,g);(0,o.useEffect)(()=>{P()},[]);let P=async()=>{if(!k){let e=ee(),{reservations:r,lock:a,error:s}=await M.initiateWorkflow(e);switch(s){case m.Jr.HOLD_WAITLIST_FULL:J((0,u.fX)(s)),O(null),Q();return;case m.Jr.HOLD_SESSION_FULL:J((0,u.fX)(s)),O(null),$();return}if(r||D.redirectToIDMS(U.id),a)O(a);else if(U.status!==m.N3.WAITLIST){let r=await M.getWorkshopStatus(e);(0,v.cK)(U.status,r.eventStatus)?Y():K(V.Lo.GENERIC_ERROR)}else K(V.Lo.GENERIC_ERROR)}},{course:A,schedule:U,store:z}=a,F={storeTitle:z.title,courseName:A.name,programName:A.collectionName,isMultiLanguage:t.isMultiLanguage(),lang:U.lang,sessions:U.displayDate},Z=e=>{if(e){let r=setTimeout(()=>{K(V.Lo.SESSION_WARNING)},Date.parse(e.expiration)-Date.now()-3e5);O({...e,timeoutHandler:r})}else{if(!(e=k))return;clearTimeout(e.timeoutHandler),O(null)}},G=async e=>{let{reservation:r}=await M.createReservation({...ee(),payload:{...e,lockId:null==k?void 0:k.lockId,isWaitlist:U.status===m.N3.WAITLIST}});if(!r)return K(V.Lo.GENERIC_ERROR),!1;{let e=r.status;switch(e){case V.Lo.FORBIDDEN:return D.redirectToIDMS(U.id),!1;case V.Lo.ALREADY_RESERVED:case V.Lo.WAITLIST_FULL:case V.Lo.LIMIT:case V.Lo.IN_PROGRESS:case V.Lo.UNAVAILABLE:return K(e),!1;case V.Lo.RSVP_FULL:return Y(),!1;case V.Lo.RSVP:case V.Lo.RESERVED:case V.Lo.WAITLIST:case V.Lo.HOLD_WAITLIST_FULL:return J(r),Z(null),Q(),!0;case V.Lo.GENERIC_ERROR:default:return K(V.Lo.NON_RSVP),!1}}},H=async e=>{try{X(e);let r=ee(),a=await W.lockSession(r);O(a)}catch(e){K(V.Lo.GENERIC_ERROR)}},Y=()=>{K(V.Lo.RSVP_FULL)},J=e=>{s(r=>({...r,reservation:e,reservationUpdateTime:Date.now()}))},K=e=>{I(e)},X=e=>{s(r=>({...r,schedule:{...U,status:e}}))},Q=()=>{let e=i.getPageRoute(m.q.EVENT),r=new URLSearchParams((0,N.LV)("",U.storeNum)),a=(0,N.Vf)(e,{courseSlug:A.urlTitle,scheduleId:U.id,stageRootPath:T.urlStageRootPath});h.push("".concat(a,"?").concat(r.toString()))},$=()=>{let e=i.getPageRoute(m.q.DISCOVER),r=new URLSearchParams,a=(0,N.Vf)(e,{stageRootPath:T.stageRootPath});r.append(N.az.ERROR,N.K.HOLD_SESSION_FULL),h.push("".concat(a,"?").concat(r.toString()))},ee=()=>({schedule:U,course:A,storeInfo:z,localeId:T.id});return(0,n.jsxs)("section",{className:"section-content",children:[(0,n.jsx)("article",{className:"row ".concat("camp-registration-page","__header"),children:(0,n.jsx)("div",{className:"column large-8 medium-11 small-12 large-centered",children:(0,n.jsx)(q,{i18n:l,submit:G,...F})})}),(0,n.jsx)(V.M6,{status:w,errorMapping:{...B.getMappings(),[V.Lo.RSVP_FULL]:{label:"error.camp-session-full",buttons:[{text:"global.cta-yes",callback:()=>{H(m.N3.WAITLIST)}},{text:"global.cta-no",callback:Q}]}},redirectOnErrorCallback:()=>{let e=i.getPageRoute(m.q.CAMP),r=(0,N.Vf)(e,{stageRootPath:T.urlStageRootPath});h.push(r)},onClose:()=>{I(null)}})]})}},30416:function(){},75749:function(){},71402:function(){},1225:function(){},73307:function(){},47745:function(){},21424:function(){}},function(e){e.O(0,[4153,3261,9064,9561,2549,9434,5161,1363,8340,726,3160,7961,4676,7369,9022,4494,8124,3571,8423,8529,1534,5522,6235,3663,1530,4662,3232,34,9329,5739,3012,6492,8759,6522,6172,8452,83,130,3005,7801,9577,9574,1856,6123,2678,1521,5025,323,2971,2117,1744],function(){return e(e.s=97206)}),_N_E=e.O()}]);